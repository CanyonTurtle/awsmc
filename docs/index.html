<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><title>awsmc pre-alpha prototype</title></head><body><div id="canvas-container"><div id="cartdata" data-cart="AGFzbQEAAAABKAZgAABgAAF/YAV/f39/fwBgC39/f39/f39/f39/AGACfHwBfGABfwACFwIDZW52BGZpbGwAAgNlbnYEYmxpdAADAwcGAAEABAEFBAUBcAECAgUGAQGCA4IDBgkBfwFBgICABAsHZAcGbWVtb3J5AgAJY29uZmlndXJlAAMGdXBkYXRlAAQLX2luaXRpYWxpemUAAhlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQAJc3RhY2tTYXZlAAYMc3RhY2tSZXN0b3JlAAcJBwEAQQELAQIKrB0GAgALRQBB0K2GBEEBOwEAQcythgRBgIGABjYCAEHIrYYEQYCBhgQ2AgBBxK2GBEHAgIYENgIAQcCthgRBwICABDYCAEHArYYEC7sLAw9/A30BfCMAQSBrIgMkAEGwgIAEQbCAgAQoAgBBAWoiATYCACABQQVJIQYDQAJAAkACfwJAIARBCkYEQCAHQf8BcUUEQEG0gIAEQQA6AAALIAZFDQNBACEAQbCAgAQoAgAiCEEObiEGIAi4RM3MzMzMzOw/EAUiEkQAAAAAAADwQWMgEkQAAAAAAAAAAGZxRQ0BIBKrDAILIARBBmxBwICGBGoiAS8BACIJRQ0DIAEvAQIiAkUNAyABLwEERQ0DIAJBCXQgCUECdGohAUEAIQADQCAAQQRGBEBBtICABC0AAEUEQEG0gIAEQQE6AABBASEGCyAJQQdrwSILIAJBB2vBIgpBD0EPIAMtAB8iBSADLQAdIgxBEHQgAy0AHCINQRh0ciADLQAeIg5BCHRychAAQQEhBwwFBSADQRxqIABqIAAgAXJBwICABGotAAA6AAAgAEEBaiEADAELAAsAC0EACyEEIAhBAXYhCQNAIABBgMABRgRAIAvBIArBQQ9BDyAFQf8BcSAMQRB0IA1BGHRyIA5BCHRychAABSAAQQJ0QcCAgARqIgdBAWoiAi0AACEBIAICfwJ/IABBA2y4RClcj8L1KPA/EAUiEkQAAAAAAADwQWMgEkQAAAAAAAAAAGZxBEAgEqsMAQtBAAsgBmpB/wFxs0MAAAA/lCIPQwAAgE9dIA9DAAAAAGBxBEAgD6kMAQtBAAsgAWo6AAAgB0EDaiICLQAAIQEgAgJ/An8gALhEmpmZmZmZ8T8QBSISRAAAAAAAAPBBYyASRAAAAAAAAAAAZnEEQCASqwwBC0EACyAEakG+AXCzQwAAAD+UQwAAIEGSIg9DAACAT10gD0MAAAAAYHEEQCAPqQwBC0EACyABajoAACAHLQAAIQEgBwJ/An8gAEEBdLhEMzMzMzMz8z8QBSISRAAAAAAAAPBBYyASRAAAAAAAAAAAZnEEQCASqwwBC0EACyAJakHIAXCzQwAAAD+UQwAA8EGSIg9DAACAT10gD0MAAAAAYHEEQCAPqQwBC0EACyABajoAACAHQQJqIgItAAAhASACAn8gCAJ/IABBBWy4RK5H4XoUru8/EAUiEkQAAAAAAADwQWMgEkQAAAAAAAAAAGZxBEAgEqsMAQtBAAtBCm5qQdwBcLNDAAAAP5QiD0MAAIBPXSAPQwAAAABgcQRAIA+pDAELQQALIAFqOgAAIABBAWohAAwBCwsLIANCgICA/IOAgMA/NwMIIANCgICA/IOAgMA/NwMAQQAhAANAIABBwAFHBEBBACEFIABBAWoiAUEJdEEAIAFBwAFHGyEKIABBB3QhCCAAQQFrQcABcEEJdCELA0AgBUGAAUYEQCABIQAMAwsgBUECdCIAIApyIQQgACALciEGIAUgCHJBAnQhDCAFQQFrQf8AcSAIckECdCENIAVBAWoiBUH/AHEgCHJBAnQhDkEAIQADQCAAQQRGDQECfyADIABBAnRqKgIAIg9DwcqBPpQiECAAIAZyQcCAgARqLQAAs5QiEUMAAIBPXSARQwAAAABgcQRAIBGpDAELQQALAn8gD0PByoG/lEMAAIA/kiAAIAxyQcCAgARqIgktAACzlCIPQwAAgE9dIA9DAAAAAGBxBEAgD6kMAQtBAAtqIQICfyAQIAAgBHJBwICABGotAACzlCIPQwAAgE9dIA9DAAAAAGBxBEAgD6kMAQtBAAsgAmohAgJ/IBAgACAOckHAgIAEai0AALOUIg9DAACAT10gD0MAAAAAYHEEQCAPqQwBC0EACyACaiECIAkCfyAQIAAgDXJBwICABGotAACzlCIPQwAAgE9dIA9DAAAAAGBxBEAgD6kMAQtBAAsgAmo6AAAgAEEBaiEADAALAAsACwtBgIGGBEEAQQBB2QBBwICABEEUQdgAQYABQdkAQRBBABABIANBIGokAA8LIARBAWohBAwACwALlxEDCX8HfAJ+RAAAAAAAAPA/IQwCQAJAAkAgAb0iE0IgiKciCEH/////B3EiBSATpyIKckUNACAAvSISQiCIpyEGIBKnIgNFIAZBgIDA/wNGcQ0AIAZB/////wdxIgdBgIDA/wdLIAdBgIDA/wdGIANBAEdxciAFQYCAwP8HS3JFIApFIAVBgIDA/wdHcnFFBEAgACABoA8LAkACQAJAAkACQAJ/QQAgEkIAWQ0AGkECIAVB////mQRLDQAaQQAgBUGAgMD/A0kNABogBUEUdiECIAVBgICAigRJDQFBACAKQbMIIAJrIgR2IgIgBHQgCkcNABpBAiACQQFxawshCSAKDQIgBUGAgMD/B0cNASAHQYCAwP8DayADckUNBSAHQYCAwP8DSQ0DIAFEAAAAAAAAAAAgE0IAWRsPCyAKDQEgBUGTCCACayIEdiICIAR0IAVHDQBBAiACQQFxayEJCyAFQYCAwP8DRgRAIBNCAFkEQCAADwtEAAAAAAAA8D8gAKMPCyAIQYCAgIAERgRAIAAgAKIPCyAIQYCAgP8DRyASQgBTcg0AIACfDwsgAJkhCyADDQECQCAGQQBIBEAgBkGAgICAeEYgBkGAgMD/e0ZyIAZBgIBARnINAQwDCyAGRSAGQYCAwP8HRnINACAGQYCAwP8DRw0CC0QAAAAAAADwPyALoyALIBNCAFMbIQwgEkIAWQ0CQYCAwP8DIAdrIAlGBEAgDCAMoSIAIACjDwsgDJogDCAJQQFGGw8LRAAAAAAAAAAAIAGaIBNCAFkbDwtEAAAAAAAA8D8hDQJAIBJCAFkNAAJAAkAgCQ4CAAECCyAAIAChIgAgAKMPC0QAAAAAAADwvyENCwJ8IAVBgYCAjwRPBEAgBUGBgMCfBE8EQCAHQf//v/8DTQRARAAAAAAAAPB/RAAAAAAAAAAAIBNCAFMbDwtEAAAAAAAA8H9EAAAAAAAAAAAgCEEAShsPCyAHQf7/v/8DTQRAIA1EnHUAiDzkN36iRJx1AIg85Dd+oiANRFnz+MIfbqUBokRZ8/jCH26lAaIgE0IAUxsPCyAHQYGAwP8DTwRAIA1EnHUAiDzkN36iRJx1AIg85Dd+oiANRFnz+MIfbqUBokRZ8/jCH26lAaIgCEEAShsPCyALRAAAAAAAAPC/oCIMRETfXfgLrlQ+oiAMIAyiRAAAAAAAAOA/IAwgDEQAAAAAAADQv6JEVVVVVVVV1T+goqGiRP6CK2VHFfe/oqAiACAAIAxEAAAAYEcV9z+iIgygvUKAgICAcIO/IgAgDKGhDAELIAtEAAAAAAAAQEOiIgwgCyAHQYCAwABJIgQbIQAgDL1CIIinIAcgBBsiAkH//z9xIghBgIDA/wNyIQkgAkEUdUHMd0GBeCAEG2ohA0EAIQICQCAIQY+xDkkNACAIQfrsLkkEQEEBIQIMAQsgCEGAgID/A3IhCSADQQFqIQMLIAJBA3QiBEGQgIAEaisDACAAvUL/////D4MgCa1CIIaEvyIOIARBgICABGorAwAiC6EiDEQAAAAAAADwPyALIA6goyIAoiIQvUKAgICAcIO/Ig8gDyAPoiIRRAAAAAAAAAhAoCAAIAwgDyACQRJ0IAlBAXZqQYCAoIACaq1CIIa/IgCioSAPIA4gACALoaGioaIiCyAQIA+goiAQIBCiIgAgAKIgACAAIAAgACAARO9ORUoofso/okRl28mTSobNP6CiRAFBHalgdNE/oKJETSaPUVVV1T+gokT/q2/btm3bP6CiRAMzMzMzM+M/oKKgIgCgvUKAgICAcIO/Ig6iIgwgCyAOoiAQIAAgDkQAAAAAAAAIwKAgEaGhoqAiAKC9QoCAgIBwg78iC0T1AVsU4C8+vqIgACALIAyhoUT9AzrcCcfuP6KgoCIAIARBoICABGorAwAiESAAIAtEAAAA4AnH7j+iIgugoCADtyIMoL1CgICAgHCDvyIAIAyhIBGhIAuhoQshCyABIBNCgICAgHCDvyIMoSAAoiALIAGioCILIAAgDKIiAaAiAL0iEqchAgJAIBJCIIinIgNBgIDAhAROBEAgA0GAgMCEBGsgAnINAyALRP6CK2VHFZc8oCAAIAGhZEUNAQwDCyADQYD4//8HcUGAmMOEBEkNACADQYDovPsDaiACcg0DIAsgACABoWVFDQAMAwtBACECIA0CfCADQf////8HcSIEQYGAgP8DTwR+QQBBgIDAACAEQRR2Qf4Ha3YgA2oiA0H//z9xQYCAwAByQZMIIANBFHZB/w9xIgRrdiICayACIBJCAFMbIQIgCyABQYCAQCAEQf8Ha3UgA3GtQiCGv6EiAaC9BSASC0KAgICAcIO/IgBEAAAAAEMu5j+iIgwgCyAAIAGhoUTvOfr+Qi7mP6IgAEQ5bKgMYVwgvqKgIgGgIgsgCyALIAsgC6IiACAAIAAgACAARNCkvnJpN2Y+okTxa9LFQb27vqCiRCzeJa9qVhE/oKJEk72+FmzBZr+gokQ+VVVVVVXFP6CioSIAoiAARAAAAAAAAADAoKMgCyABIAsgDKGhIgCiIACgoaFEAAAAAAAA8D+gIgC9IhJCIIinIAJBFHRqIgRB//8/TARAAkAgAkGACE4EQCAARAAAAAAAAOB/oiEAIAJB/w9JBEAgAkH/B2shAgwCCyAARAAAAAAAAOB/oiEAQf0XIAIgAkH9F08bQf4PayECDAELIAJBgXhKDQAgAEQAAAAAAABgA6IhACACQbhwSwRAIAJByQdqIQIMAQsgAEQAAAAAAABgA6IhAEHwaCACIAJB8GhNG0GSD2ohAgsgACACQf8Haq1CNIa/ogwBCyASQv////8PgyAErUIghoS/C6IhDAsgDA8LIA1EnHUAiDzkN36iRJx1AIg85Dd+og8LIA1EWfP4wh9upQGiRFnz+MIfbqUBogsEACMACwYAIAAkAAsLMAIAQYaAgAQLGvA/AAAAAAAA+D8AAAAAAAAAAAbQz0Pr/Uw+AEGrgIAECwVAA7jiPw==" data-cartlen="4030" data-spritesheet="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFkAAAAQCAYAAAB9XNMLAAAAAXNSR0IArs4c6QAAAd5JREFUWIXFWNt2xCAIHPb0/3/ZPnRNlcxwSbIt5+zDGoQRRkQNQsYYAwDMDACsqBfqRvOZr/Ubkwzbp8XjW2JwDAHA60GHl+YZQdb0OdzYeC8+BVTVY/MYAcYYx28OASLIxEAHyLVoJxjMDLbIokd9qvGregpXYhcARspknxUvZMEtqYL2GHywhe1tjvLbSAhLvNyNk9VfmeGpfGNXPyILhrnQn4K8J5ky2swGbtZucnYcfxWOOXYKsjfmcN8Ge0cmFhbsfxDp1zNblgvP3GhXk+2ybkV5EAXsCMsBO1w6ohivbDVL2km2IBNjbJGhw5t4zj1QUKeSxOfO/qgEypos2qN1q6YIRZdi4psUFmg3/5Ey1qzfZZ/tPrkSm/d2PiVoAbfJpxm1EoZ0CKZ0n5KDydHNi4GDy6SZWcbOuROE3onhjRvdftz/cycE7Os4MVkBvNoP+z7Szy0EJDwwg7GQoWsCs35bsJ1iY1heCnRRKm8Lle/bjjiM/15TZ3eydSkZ04PgtKUSaHbdNjNZkynwjM2CEZQt3Qcl/y5QLSXVt5HKVT3ARN8ypslX1KsWQavrdmVumszANr3pVYKvdLplo+ADAO8uyoYSNlvHVmDHj0/b5W+Vd467uAiO4+83oe+EB/spYGEAAAAASUVORK5CYII="></div><canvas id="screen"></canvas><div id="top"><span id="fpsOut">fps</span>&#160;<a href="https://github.com/CanyonTurtle/awsmc">source</a>&#160;<button type="button" id="fullscreen-btn">Fullscreen</button>&#160;<button type="button" id="record-btn">Record</button></div></div><style>#screen{image-rendering:pixelated}body,html{margin:0;width:100%;height:100%;background-color:#fff}#top{position:absolute;top:10px;left:10px;z-index:10;display:inline}#canvas-container{width:100%;height:100%;display:flex;justify-content:center;align-items:center}</style><script>var S=4,r=10,v=6,_="LRUDabcdefghijklmnopqrstuvwxyz 1",f=64,n=256;function l(e,t){void 0===t&&(t="+/");for(var n,i=t.charCodeAt(0),r=t.charCodeAt(1),o=new Uint8Array(Math.floor(e.length/4*3)),a=0,f=0,c=new Array(4);f<e.length;){for(var s=0;s<4&&f<e.length;){if((n=e.charCodeAt(f++))>=65&&n<=90)n-=65;else if(n>=97&&n<=122)n-=71;else if(n>=48&&n<=57)n+=4;else if(n==i)n=62;else{if(n!=r)continue;n=63}c[s]=n,s+=1}if(4!=s)for(var u=s;u<4;u++)c[u]=0;o[a+0]=c[0]<<2|c[1]>>4,o[a+1]=(15&c[1])<<4|c[2]>>2,o[a+2]=(3&c[2])<<6|c[3],a+=s-1}return new Uint8Array(o.buffer,0,a)}function q0(){if(null==document.fullscreenElement){let e=function(){const e=window.frameElement;if(e){let t=e;t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.zIndex="99999",t.style.width="100%",t.style.height="100%"}};const t=document.body.requestFullscreen&&document.body.requestFullscreen({navigationUI:"hide"});t?t.catch(e):e()}else document.exitFullscreen()}var G0=function(e){let t=e.memory;e.buffers.inputs=new Uint8Array(t.buffer,e.config.info_addr+12,n);const i=e.buffers.inputs;i.fill(0);let o=0;for(let[t,n]of e._runtime_state.active_touches.entries()){let[t,r,a]=n;const c=f*e.info.netplay_client_number+o*v;i[c+1]=t>>8&255,i[c+0]=t,i[c+3]=r>>8&255,i[c+2]=r,i[c+5]=a>>8&255,i[c+4]=a,o+=1}const a=new Uint16Array(t.buffer,e.config.info_addr+12+f*e.info.netplay_client_number+r*v,2),c=e.info.inputs[e.info.netplay_client_number].keys_input;a[1]=c>>16&65535,a[0]=c,e.info.touch_generation+=1},J0=function(e){let t=!1;function n(e,t){e.preventDefault();const n=e.changedTouches;for(let e=0;e<n.length;e++){const i=n[e];r(i.identifier,t,i.clientX,i.clientY)}}function i(e,t){e.preventDefault(),r(-1,t,e.clientX,e.clientY)}function r(t,n,i,r){if(n)return void e._runtime_state.active_touches.delete(t);const o=document.getElementById("screen"),a=o.getBoundingClientRect(),f=o.width/a.width,c=o.height/a.height,s=Math.floor((i-a.left)*f),u=Math.floor((r-a.top)*c);s<0||s>=o.width||u<0||u>=o.height?e._runtime_state.active_touches.delete(t):e._runtime_state.active_touches.set(t,[s,u,e.info.touch_generation])}e._runtime_state.active_touches=new Map,e.info.touch_generation=0;const o=e=>{n(e,!1)},a=e=>{n(e,!0)},f=e=>{t&&i(e,!1)},c=e=>{t=!0,i(e,!1)},s=e=>{t=!1,i(e,!0)},u=new Map([["Space",30],["ArrowLeft",0],["ArrowRight",1],["ArrowUp",2],["ArrowDown",3],["Digit1",31]]),d=e=>{let t;if(!e.isComposing){if(e.code.startsWith("Key")){const n=e.code[3].toLowerCase();t=_.indexOf(n)}else{if(!u.has(e.code))return;t=u.get(e.code)}return t}},l=t=>{const n=d(t);void 0!==n&&(e.info.inputs[e.info.netplay_client_number].keys_input|=1<<31-n)},h=t=>{const n=d(t);void 0!==n&&(e.info.inputs[e.info.netplay_client_number].keys_input&=~(1<<31-n))},g=document.getElementById("screen"),m=(e,t,n)=>{e.removeEventListener(t,n),e.addEventListener(t,n,{passive:!1})};for(let[e,t,n]of[[g,"touchstart",o],[g,"touchmove",o],[g,"touchend",a],[g,"touchcancel",a],[g,"mousemove",f],[g,"mousedown",c],[g,"mouseup",s],[window,"keydown",l],[window,"keyup",h]])m(e,t,n);document.getElementById("fullscreen-btn").addEventListener("click",(e=>{e.preventDefault(),q0()}))};async function Q0(t,n){let i=t.memory;t.buffers.config=new Uint16Array(i.buffer,n,9);const r=t.buffers.config;if(t.config={framebuffer_addr:r[1]<<16&4294901760|65535&r[0],info_addr:r[3]<<16&4294901760|65535&r[2],spritesheet_addr:r[5]<<16&4294901760|65535&r[4],logical_width_px:r[6],logical_height_px:r[7],max_n_players:r[8]},0!=t.config.spritesheet_addr){const e=document.getElementById("cartdata").getAttribute("data-spritesheet"),n=new Image;n.src=e,await n.decode();const r=document.createElement("canvas"),o=r.getContext("2d");r.width=n.width,r.height=n.height,o.drawImage(n,0,0);const a=o.getImageData(0,0,n.width,n.height).data;t.buffers.spritesheet_buffer=new Uint8Array(i.buffer,t.config.spritesheet_addr,n.width*n.height*S),t.buffers.spritesheet_buffer.set(a),t._runtime_state.spritesheet_info={width:n.width,height:n.height}}t.buffers.framebuffer=new Uint8Array(i.buffer,t.config.framebuffer_addr,t.config.logical_width_px*t.config.logical_height_px*S);const o=document.getElementById("screen");if(o.width=t.config.logical_width_px,o.height=t.config.logical_height_px,!(q=o.getContext("webgl")))return void alert("WebGL not supported");const a=q.createShader(q.VERTEX_SHADER);if(q.shaderSource(a,e),q.compileShader(a),!q.getShaderParameter(a,q.COMPILE_STATUS))return void console.error("Vertex shader compilation error:",q.getShaderInfoLog(a));const f=q.createShader(q.FRAGMENT_SHADER);if(q.shaderSource(f,s),q.compileShader(f),!q.getShaderParameter(f,q.COMPILE_STATUS))return void console.error("Fragment shader compilation error:",q.getShaderInfoLog(f));const c=q.createProgram();q.attachShader(c,a),q.attachShader(c,f),q.linkProgram(c),q.useProgram(c);const u=q.createBuffer();q.bindBuffer(q.ARRAY_BUFFER,u),q.bufferData(q.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,1,1,-1,-1,-1]),q.STATIC_DRAW);const d=q.getAttribLocation(c,"a_position");q.enableVertexAttribArray(d),q.vertexAttribPointer(d,2,q.FLOAT,!1,0,0);const l=q.createTexture();q.bindTexture(q.TEXTURE_2D,l),q.texImage2D(q.TEXTURE_2D,0,q.RGBA,t.config.logical_width_px,t.config.logical_height_px,0,q.RGBA,q.UNSIGNED_BYTE,t.buffers.framebuffer),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.NEAREST),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.NEAREST),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,!0),q.uniform1i(q.getUniformLocation(c,"u_texture"),0);const _=q.getUniformLocation(c,"u_resolution");q.uniform2f(_,t.config.logical_width_px,t.config.logical_height_px),J0(t)}function $0(e){G0(e);let t=(u=new Date).getTime()-a.getTime();w+=(t-w)/D0,a=u,q.texSubImage2D(q.TEXTURE_2D,0,0,0,e.config.logical_width_px,e.config.logical_height_px,q.RGBA,q.UNSIGNED_BYTE,e.buffers.framebuffer),q.clearColor(0,0,0,1),q.clear(q.COLOR_BUFFER_BIT),q.drawArrays(q.TRIANGLE_STRIP,0,6)}async function z0(){let e={memory:void 0,buffers:{config:void 0,framebuffer:void 0,inputs:void 0,spritesheet_buffer:void 0},config:{framebuffer_addr:0,info_addr:0,spritesheet_addr:0,logical_width_px:64,logical_height_px:64,max_n_players:0},info:{device_width:64,device_height:64,netplay_client_number:0,inputs:[{touches:[],keys_input:0}],touch_generation:0},exported_functions:{_configure:void 0,_update:void 0},provided_builtins:{},_runtime_state:{active_touches:new Map,spritesheet_info:void 0,is_little_endian:function(){var e=new ArrayBuffer(2),t=new Uint8Array(e),n=new Uint16Array(e);if(t[0]=170,t[1]=187,48042===n[0])return!0;if(43707===n[0])return!1;throw new Error("Something crazy just happened")}()}};function t(t,n,i,r,o,a,f,c,s,u,d){let l,_;l=o===e.config.framebuffer_addr?e.buffers.framebuffer:new Uint8Array(e.memory.buffer,o),_=t===e.config.spritesheet_addr?e.buffers.spritesheet_buffer:new Uint8Array(e.memory.buffer,t);const[h,g,m]=0!=(1&d)?[s,-1,-1]:[0,s,1],[p,b,w]=0!=(16&d)?[u,-1,-1]:[0,u,1];for(let e=0;e<u;e++){const t=0==(16&d)?e:u-1-e;for(let o=0;o<s;o++){const u=0==(1&d)?o:s-1-o;let h=_[((i+e)*r+(n+o))*S+3];if(0!==h){const s=((f+t)*c+(a+u))*S,d=((i+e)*r+(n+o))*S;l[s]=_[d],l[s+1]=_[d+1],l[s+2]=_[d+2],l[s+3]=h}}}}function n(t){return e._runtime_state.is_little_endian?function(e){return(e>>>24&255|e>>>8&65280|e<<8&16711680|e<<24&4278190080)>>>0}(t):t}function i(t,n,i,r){new Uint32Array(e.buffers.framebuffer.buffer,e.buffers.framebuffer.byteOffset+i*e.config.logical_width_px*4+4*t,n-t).fill(r)}const r={env:{blit:t,draw_ss:function(n,i,r,o,a,f,c){void 0!==e._runtime_state.spritesheet_info&&t(e.buffers.spritesheet_buffer.byteOffset,n,i,e._runtime_state.spritesheet_info.width,e.buffers.framebuffer.byteOffset,r,o,e.config.logical_width_px,a,f,c)},fill_screen:function(t){const i=n(t);new Uint32Array(e.buffers.framebuffer.buffer,e.buffers.framebuffer.byteOffset,e.buffers.framebuffer.length/4).fill(i)},fill:function(t,r,o,a,f){const c=(e,t,n)=>Math.min(n,Math.max(t,e)),[s,u]=[t,t+o].map((t=>c(t,0,e.config.logical_width_px))),[d,l]=[r,r+a].map((t=>c(t,0,e.config.logical_height_px))),_=n(f);for(let e=d;e<l;e++)i(s,u,e,_)}}},o=document.getElementById("cartdata"),a=o.getAttribute("data-cart"),f=(Number(o.getAttribute("data-cartlen")),l(a,void 0)),{instance:c}=await WebAssembly.instantiate(f,r);return e.memory=c.exports.memory,e.exported_functions._configure=c.exports.configure,e.exported_functions._update=c.exports.update,e}var q,e="\n    attribute vec2 a_position;\n    void main() {\n        gl_Position = vec4(a_position, 0, 1);\n    }\n",s="\n    precision mediump float;\n    uniform sampler2D u_texture;\n    uniform vec2 u_resolution;\n    void main() {\n        vec2 uv = gl_FragCoord.xy / u_resolution;\n        gl_FragColor = texture2D(u_texture, uv);\n    }\n",D0=20,w=0,a=new Date,u=new Date;async function t(){const e=await z0(),t=e.exported_functions._configure();await Q0(e,t),setInterval((()=>{e.exported_functions._update(),$0(e)}),16.666666666666668);const n=document.getElementById("screen"),i=e.config.logical_width_px,r=e.config.logical_height_px;function o(){const t=n.parentNode.clientWidth,o=n.parentNode.clientHeight;e.info.device_width=t,e.info.device_height=o;const a=t/i,f=o/r;let c=Math.min(a,f);const s=Math.floor(i*c),u=Math.floor(r*c);n.style.width=s+"px",n.style.height=u+"px"}o(),window.addEventListener("resize",o);var a=document.getElementById("fpsOut");setInterval((function(){a.innerHTML=(1e3/w).toFixed(1)+" fps"}),1e3)}var x,i,K0=document.getElementById("screen"),h=document.getElementById("record-btn"),g=!1;h.addEventListener("click",(()=>{if(g=!g){h.textContent="Stop";const e=K0.captureStream(60);x=new MediaRecorder(e,{mimeType:"video/webm;codecs=vp9",ignoreMutedMedia:!0}),i=[],x.ondataavailable=e=>{e.data.size>0&&i.push(e.data)},x.start()}else h.textContent="Record",x.stop(),setTimeout((()=>{const e=new Blob(i,{type:"video/webm"}),t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="recording.webm",n.click(),URL.revokeObjectURL(t)}),0)})),t()</script></body></html>