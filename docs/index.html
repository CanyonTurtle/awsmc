<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><title>AWSM pre-alpha prototype</title></head><body><div id="canvas-container"><div id="cartdata" data-cart="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" data-cartlen="3373"></div><canvas id="screen"></canvas><div id="top"><span id="fpsOut">fps</span><a href="https://github.com/CanyonTurtle/awsmc">source</a><button type="button" id="fullscreen-btn">Fullscreen</button></div></div><style>#screen{image-rendering:pixelated}body,html{margin:0;width:100%;height:100%;background-color:#fff}#top{position:absolute;top:10px;left:10px;z-index:10;display:inline}#canvas-container{width:100%;height:100%;display:flex;justify-content:center;align-items:center}</style><script>function H(e,t){void 0===t&&(t="+/");for(var n,o=t.charCodeAt(0),i=t.charCodeAt(1),r=new Uint8Array(Math.floor(e.length/4*3)),a=0,c=0,l=new Array(4);c<e.length;){for(var f=0;f<4&&c<e.length;){if((n=e.charCodeAt(c++))>=65&&n<=90)n-=65;else if(n>=97&&n<=122)n-=71;else if(n>=48&&n<=57)n+=4;else if(n==o)n=62;else{if(n!=i)continue;n=63}l[f]=n,f+=1}if(4!=f)for(var u=f;u<4;u++)l[u]=0;r[a+0]=l[0]<<2|l[1]>>4,r[a+1]=(15&l[1])<<4|l[2]>>2,r[a+2]=(3&l[2])<<6|l[3],a+=f-1}return new Uint8Array(r.buffer,0,a)}function v(){if(null==document.fullscreenElement){let e=function(){const e=window.frameElement;if(e){let t=e;t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.zIndex="99999",t.style.width="100%",t.style.height="100%"}};const t=document.body.requestFullscreen&&document.body.requestFullscreen({navigationUI:"hide"});t?t.catch(e):e()}}var f=function(e){let t=e.memory,n=new Uint8Array(t.buffer,e.config.info_addr,p*E);n.fill(0);let o=0;for(let[t,i]of e.info.player_inputs[0].active_touches.entries()){let[e,t,r]=i;const a=o*E;n[a+1]=e>>8&255,n[a+0]=e,n[a+3]=t>>8&255,n[a+2]=t,n[a+5]=r>>8&255,n[a+4]=r,o+=1}e.info.touch_generation+=1},u=function(e){let t=!1;function n(e,t){e.preventDefault();const n=e.changedTouches;for(let e=0;e<n.length;e++){const o=n[e];i(o.identifier,t,o.clientX,o.clientY)}}function o(e,t){e.preventDefault(),i(-1,t,e.clientX,e.clientY)}function i(t,n,o,i){if(n)return void e.info.player_inputs[0].active_touches.delete(t);const r=document.getElementById("screen"),a=r.getBoundingClientRect(),c=r.width/a.width,l=r.height/a.height,f=Math.floor((o-a.left)*c),u=Math.floor((i-a.top)*l);f<0||f>=r.width||u<0||u>=r.height?e.info.player_inputs[0].active_touches.delete(t):e.info.player_inputs[0].active_touches.set(t,[f,u,e.info.touch_generation])}e.info.player_inputs[0].active_touches=new Map,e.info.touch_generation=0;const r=e=>{n(e,!1)},a=e=>{n(e,!0)},c=e=>{t&&o(e,!1)},l=e=>{t=!0,o(e,!1)},f=e=>{t=!1,o(e,!0)},u=document.getElementById("screen"),_=(e,t)=>{u.removeEventListener(e,t),u.addEventListener(e,t,{passive:!1})};for(let[e,t]of[["touchstart",r],["touchmove",r],["touchend",a],["touchcancel",a],["mousemove",c],["mousedown",l],["mouseup",f]])_(e,t);document.getElementById("fullscreen-btn").addEventListener("click",(e=>{e.preventDefault(),v()}))};function d(e){let t=e.memory;const n=new Uint16Array(t.buffer,b,7);e.config={framebuffer_addr:n[1]<<16&4294901760|65535&n[0],info_addr:n[3]<<16&4294901760|65535&n[2],logical_width_px:n[4],logical_height_px:n[5],max_n_players:n[6]};const o=new Uint8Array(t.buffer,e.config.framebuffer_addr,e.config.logical_width_px*e.config.logical_height_px*R),i=document.getElementById("screen");if(i.width=e.config.logical_width_px,i.height=e.config.logical_height_px,!(G=i.getContext("webgl")))return void alert("WebGL not supported");const r=G.createShader(G.VERTEX_SHADER);if(G.shaderSource(r,x),G.compileShader(r),!G.getShaderParameter(r,G.COMPILE_STATUS))return void console.error("Vertex shader compilation error:",G.getShaderInfoLog(r));const a=G.createShader(G.FRAGMENT_SHADER);if(G.shaderSource(a,k),G.compileShader(a),!G.getShaderParameter(a,G.COMPILE_STATUS))return void console.error("Fragment shader compilation error:",G.getShaderInfoLog(a));const c=G.createProgram();G.attachShader(c,r),G.attachShader(c,a),G.linkProgram(c),G.useProgram(c);const l=G.createBuffer();G.bindBuffer(G.ARRAY_BUFFER,l),G.bufferData(G.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,1,1,-1,-1,-1]),G.STATIC_DRAW);const f=G.getAttribLocation(c,"a_position");G.enableVertexAttribArray(f),G.vertexAttribPointer(f,2,G.FLOAT,!1,0,0);const _=G.createTexture();G.bindTexture(G.TEXTURE_2D,_),G.texImage2D(G.TEXTURE_2D,0,G.RGBA,e.config.logical_width_px,e.config.logical_height_px,0,G.RGBA,G.UNSIGNED_BYTE,o),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MIN_FILTER,G.NEAREST),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MAG_FILTER,G.NEAREST),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE),G.pixelStorei(G.UNPACK_FLIP_Y_WEBGL,!0),G.uniform1i(G.getUniformLocation(c,"u_texture"),0);const d=G.getUniformLocation(c,"u_resolution");G.uniform2f(d,e.config.logical_width_px,e.config.logical_height_px),u(e)}function h(e){f(e);let t=e.memory,n=(j=new Date).getTime()-B.getTime();C+=(n-C)/S,B=j;const o=new Uint8Array(t.buffer,e.config.framebuffer_addr,e.config.logical_width_px*e.config.logical_height_px*R);G.texSubImage2D(G.TEXTURE_2D,0,0,0,e.config.logical_width_px,e.config.logical_height_px,G.RGBA,G.UNSIGNED_BYTE,o),G.clearColor(0,0,0,1),G.clear(G.COLOR_BUFFER_BIT),G.drawArrays(G.TRIANGLE_STRIP,0,6)}async function w(){const e=document.getElementById("cartdata"),t=e.getAttribute("data-cart"),n=(Number(e.getAttribute("data-cartlen")),H(t,void 0)),{instance:o}=await WebAssembly.instantiate(n,{env:{}});return{memory:o.exports.memory,config:{framebuffer_addr:0,info_addr:0,logical_width_px:64,logical_height_px:64,max_n_players:0},info:{device_width:64,device_height:64,netplay_player_number:0,player_inputs:[{active_touches:new Map,keys_input:0}],touch_generation:0},exported_functions:{_configure:o.exports.configure,_update:o.exports.update},provided_builtins:{}}}var G,x="\n    attribute vec2 a_position;\n    void main() {\n        gl_Position = vec4(a_position, 0, 1);\n    }\n",k="\n    precision mediump float;\n    uniform sampler2D u_texture;\n    uniform vec2 u_resolution;\n    void main() {\n        vec2 uv = gl_FragCoord.xy / u_resolution;\n        gl_FragColor = texture2D(u_texture, uv);\n    }\n",S=20,C=0,B=new Date,j=new Date,R=4,b=16,p=10,E=6;async function D(){const e=await w();e.exported_functions._configure(),d(e),setInterval((()=>{e.exported_functions._update(),h(e)}),16.666666666666668);const t=document.getElementById("screen"),n=e.config.logical_width_px,o=e.config.logical_height_px;function i(){const i=t.parentNode.clientWidth,r=t.parentNode.clientHeight;e.info.device_width=i,e.info.device_height=r;const a=i/n,c=r/o;let l=Math.min(a,c);const f=Math.floor(n*l),u=Math.floor(o*l);t.style.width=f+"px",t.style.height=u+"px"}i(),window.addEventListener("resize",i);var r=document.getElementById("fpsOut");setInterval((function(){r.innerHTML=(1e3/C).toFixed(1)+" fps"}),1e3)}D()</script></body></html>