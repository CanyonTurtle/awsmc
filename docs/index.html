<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><title>awsmc pre-alpha prototype</title></head><body><div id="canvas-container"><div id="cartdata" data-cart="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" data-cartlen="3896" data-spritesheet="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFkAAAAQCAYAAAB9XNMLAAAAAXNSR0IArs4c6QAAAd5JREFUWIXFWNt2xCAIHPb0/3/ZPnRNlcxwSbIt5+zDGoQRRkQNQsYYAwDMDACsqBfqRvOZr/Ubkwzbp8XjW2JwDAHA60GHl+YZQdb0OdzYeC8+BVTVY/MYAcYYx28OASLIxEAHyLVoJxjMDLbIokd9qvGregpXYhcARspknxUvZMEtqYL2GHywhe1tjvLbSAhLvNyNk9VfmeGpfGNXPyILhrnQn4K8J5ky2swGbtZucnYcfxWOOXYKsjfmcN8Ge0cmFhbsfxDp1zNblgvP3GhXk+2ybkV5EAXsCMsBO1w6ohivbDVL2km2IBNjbJGhw5t4zj1QUKeSxOfO/qgEypos2qN1q6YIRZdi4psUFmg3/5Ey1qzfZZ/tPrkSm/d2PiVoAbfJpxm1EoZ0CKZ0n5KDydHNi4GDy6SZWcbOuROE3onhjRvdftz/cycE7Os4MVkBvNoP+z7Szy0EJDwwg7GQoWsCs35bsJ1iY1heCnRRKm8Lle/bjjiM/15TZ3eydSkZ04PgtKUSaHbdNjNZkynwjM2CEZQt3Qcl/y5QLSXVt5HKVT3ARN8ypslX1KsWQavrdmVumszANr3pVYKvdLplo+ADAO8uyoYSNlvHVmDHj0/b5W+Vd467uAiO4+83oe+EB/spYGEAAAAASUVORK5CYII="></div><canvas id="screen"></canvas><div id="top"><span id="fpsOut">fps</span>&#160;<a href="https://github.com/CanyonTurtle/awsmc">source</a>&#160;<button type="button" id="fullscreen-btn">Fullscreen</button>&#160;<button type="button" id="record-btn">Record</button></div></div><style>#screen{image-rendering:pixelated}body,html{margin:0;width:100%;height:100%;background-color:#000}#top{position:absolute;top:10px;left:10px;z-index:10;display:inline}#canvas-container{width:100%;height:100%;display:flex;justify-content:center;align-items:center}</style><script>var y=4,a=10,u=6,c="LRUDabcdefghijklmnopqrstuvwxyz 1",g=64,i=256;function o(e,t){void 0===t&&(t="+/");for(var i,n=t.charCodeAt(0),o=t.charCodeAt(1),r=new Uint8Array(Math.floor(e.length/4*3)),a=0,f=0,c=new Array(4);f<e.length;){for(var s=0;s<4&&f<e.length;){if((i=e.charCodeAt(f++))>=65&&i<=90)i-=65;else if(i>=97&&i<=122)i-=71;else if(i>=48&&i<=57)i+=4;else if(i==n)i=62;else{if(i!=o)continue;i=63}c[s]=i,s+=1}if(4!=s)for(var u=s;u<4;u++)c[u]=0;r[a+0]=c[0]<<2|c[1]>>4,r[a+1]=(15&c[1])<<4|c[2]>>2,r[a+2]=(3&c[2])<<6|c[3],a+=s-1}return new Uint8Array(r.buffer,0,a)}function K0(){if(null==document.fullscreenElement){let e=function(){const e=window.frameElement;if(e){let t=e;t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.zIndex="99999",t.style.width="100%",t.style.height="100%"}};const t=document.body.requestFullscreen&&document.body.requestFullscreen({navigationUI:"hide"});t?t.catch(e):e()}else document.exitFullscreen()}var $0=function(e){let t=e.memory;e.buffers.info=new Uint8Array(t.buffer,e.config.info_addr,i+14),x("u32",e.buffers.info,0,e.info.device_width),x("u32",e.buffers.info,4,e.info.device_height),x("u16",e.buffers.info,8,e.info.netplay_client_number),x("u16",e.buffers.info,10,e.info.touch_generation),x("u16",e.buffers.info,12,e.info.is_mobile);const n=new Uint8Array(e.memory.buffer,e.config.info_addr+22,i);n.fill(0);let o=0;for(let[t,i]of e._runtime_state.active_touches.entries()){let[t,r,a]=i;const f=g*e.info.netplay_client_number+o*u;n[f+1]=t>>8&255,n[f+0]=t,n[f+3]=r>>8&255,n[f+2]=r,n[f+5]=a>>8&255,n[f+4]=a,o+=1}x("u32",e.buffers.info,16+g*e.info.netplay_client_number+a*u,e.info.inputs[e.info.netplay_client_number].keys_input),e.info.touch_generation+=1},V0=function(e){let t=!1;function i(e,t){e.preventDefault();const i=e.changedTouches;for(let e=0;e<i.length;e++){const n=i[e];o(n.identifier,t,n.clientX,n.clientY)}}function n(e,t){e.preventDefault(),o(-1,t,e.clientX,e.clientY)}function o(t,i,n,o){if(i)return void e._runtime_state.active_touches.delete(t);const r=document.getElementById("screen"),a=r.getBoundingClientRect(),f=r.width/a.width,c=r.height/a.height,s=Math.floor((n-a.left)*f),u=Math.floor((o-a.top)*c);s<0||s>=r.width||u<0||u>=r.height?e._runtime_state.active_touches.delete(t):e._runtime_state.active_touches.set(t,[s,u,e.info.touch_generation])}e._runtime_state.active_touches=new Map,e.info.touch_generation=0;const r=e=>{i(e,!1)},a=e=>{i(e,!0)},f=e=>{t&&n(e,!1)},s=e=>{t=!0,n(e,!1)},u=e=>{t=!1,n(e,!0)},d=new Map([["Space",30],["ArrowLeft",0],["ArrowRight",1],["ArrowUp",2],["ArrowDown",3],["Digit1",31]]),l=e=>{let t;if(!e.isComposing){if(e.code.startsWith("Key")){const i=e.code[3].toLowerCase();t=c.indexOf(i)}else{if(!d.has(e.code))return;t=d.get(e.code)}return t}},m=t=>{const i=l(t);void 0!==i&&(e.info.inputs[e.info.netplay_client_number].keys_input|=1<<31-i)},_=t=>{const i=l(t);void 0!==i&&(e.info.inputs[e.info.netplay_client_number].keys_input&=~(1<<31-i))},g=document.getElementById("screen"),h=(e,t,i)=>{e.removeEventListener(t,i),e.addEventListener(t,i,{passive:!1})};for(let[e,t,i]of[[g,"touchstart",r],[g,"touchmove",r],[g,"touchend",a],[g,"touchcancel",a],[g,"mousemove",f],[g,"mousedown",s],[g,"mouseup",u],[window,"keydown",m],[window,"keyup",_]])h(e,t,i);document.getElementById("fullscreen-btn").addEventListener("click",(e=>{e.preventDefault(),K0()}))};async function X0(e,t){let i=e.memory;e.buffers.config=new Uint16Array(i.buffer,t,9);const n=e.buffers.config;if(e.config={framebuffer_addr:n[1]<<16&4294901760|65535&n[0],info_addr:n[3]<<16&4294901760|65535&n[2],spritesheet_addr:n[5]<<16&4294901760|65535&n[4],logical_width_px:n[6],logical_height_px:n[7],max_n_players:n[8]},0!=e.config.spritesheet_addr){const t=document.getElementById("cartdata").getAttribute("data-spritesheet"),n=new Image;n.src=t,await n.decode();const o=document.createElement("canvas"),r=o.getContext("2d");o.width=n.width,o.height=n.height,r.drawImage(n,0,0);const a=r.getImageData(0,0,n.width,n.height).data;e.buffers.spritesheet_buffer=new Uint8Array(i.buffer,e.config.spritesheet_addr,n.width*n.height*y),e.buffers.spritesheet_buffer.set(a),e._runtime_state.spritesheet_info={width:n.width,height:n.height}}e.buffers.framebuffer=new Uint8Array(i.buffer,e.config.framebuffer_addr,e.config.logical_width_px*e.config.logical_height_px*y);const o=document.getElementById("screen");if(o.width=e.config.logical_width_px,o.height=e.config.logical_height_px,!(q=o.getContext("webgl")))return void alert("WebGL not supported");const r=q.createShader(q.VERTEX_SHADER);if(q.shaderSource(r,q0),q.compileShader(r),!q.getShaderParameter(r,q.COMPILE_STATUS))return void console.error("Vertex shader compilation error:",q.getShaderInfoLog(r));const a=q.createShader(q.FRAGMENT_SHADER);if(q.shaderSource(a,G0),q.compileShader(a),!q.getShaderParameter(a,q.COMPILE_STATUS))return void console.error("Fragment shader compilation error:",q.getShaderInfoLog(a));const f=q.createProgram();q.attachShader(f,r),q.attachShader(f,a),q.linkProgram(f),q.useProgram(f);const c=q.createBuffer();q.bindBuffer(q.ARRAY_BUFFER,c),q.bufferData(q.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,1,1,-1,-1,-1]),q.STATIC_DRAW);const s=q.getAttribLocation(f,"a_position");q.enableVertexAttribArray(s),q.vertexAttribPointer(s,2,q.FLOAT,!1,0,0);const u=q.createTexture();q.bindTexture(q.TEXTURE_2D,u),q.texImage2D(q.TEXTURE_2D,0,q.RGBA,e.config.logical_width_px,e.config.logical_height_px,0,q.RGBA,q.UNSIGNED_BYTE,e.buffers.framebuffer),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MIN_FILTER,q.NEAREST),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_MAG_FILTER,q.NEAREST),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_S,q.CLAMP_TO_EDGE),q.texParameteri(q.TEXTURE_2D,q.TEXTURE_WRAP_T,q.CLAMP_TO_EDGE),q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,!0),q.uniform1i(q.getUniformLocation(f,"u_texture"),0);const d=q.getUniformLocation(f,"u_resolution");q.uniform2f(d,e.config.logical_width_px,e.config.logical_height_px),V0(e)}function z0(t){$0(t);let i=(d=new Date).getTime()-e.getTime();m+=(i-m)/J0,e=d,q.texSubImage2D(q.TEXTURE_2D,0,0,0,t.config.logical_width_px,t.config.logical_height_px,q.RGBA,q.UNSIGNED_BYTE,t.buffers.framebuffer),q.clearColor(0,0,0,1),q.clear(q.COLOR_BUFFER_BIT),q.drawArrays(q.TRIANGLE_STRIP,0,6)}async function O0(){let e={memory:void 0,buffers:{config:void 0,framebuffer:void 0,info:void 0,spritesheet_buffer:void 0},config:{framebuffer_addr:0,info_addr:0,spritesheet_addr:0,logical_width_px:64,logical_height_px:64,max_n_players:0},info:{device_width:64,device_height:64,netplay_client_number:0,inputs:[{touches:[],keys_input:0}],touch_generation:0,is_mobile:Q0()?1:2},exported_functions:{_configure:void 0,_update:void 0},provided_builtins:{},_runtime_state:{active_touches:new Map,spritesheet_info:void 0,is_little_endian:function(){var e=new ArrayBuffer(2),t=new Uint8Array(e),i=new Uint16Array(e);if(t[0]=170,t[1]=187,48042===i[0])return!0;if(43707===i[0])return!1;throw new Error("Something crazy just happened")}()}};function t(t,i,n,o,r,a,f,c,s,u,d){let l,m;l=r===e.config.framebuffer_addr?e.buffers.framebuffer:new Uint8Array(e.memory.buffer,r),m=t===e.config.spritesheet_addr?e.buffers.spritesheet_buffer:new Uint8Array(e.memory.buffer,t);const[_,g,h]=0!=(1&d)?[s,-1,-1]:[0,s,1],[p,b,w]=0!=(16&d)?[u,-1,-1]:[0,u,1];for(let e=0;e<u;e++){const t=0==(16&d)?e:u-1-e;for(let r=0;r<s;r++){const u=0==(1&d)?r:s-1-r;let _=m[((n+e)*o+(i+r))*y+3];if(0!==_){const s=((f+t)*c+(a+u))*y,d=((n+e)*o+(i+r))*y;l[s]=m[d],l[s+1]=m[d+1],l[s+2]=m[d+2],l[s+3]=_}}}}function i(t){return e._runtime_state.is_little_endian?function(e){return(e>>>24&255|e>>>8&65280|e<<8&16711680|e<<24&4278190080)>>>0}(t):t}function n(t,i,n,o){new Uint32Array(e.buffers.framebuffer.buffer,e.buffers.framebuffer.byteOffset+n*e.config.logical_width_px*4+4*t,i-t).fill(o)}const r={env:{blit:t,draw_ss:function(i,n,o,r,a,f,c){void 0!==e._runtime_state.spritesheet_info&&t(e.buffers.spritesheet_buffer.byteOffset,i,n,e._runtime_state.spritesheet_info.width,e.buffers.framebuffer.byteOffset,o,r,e.config.logical_width_px,a,f,c)},fill_screen:function(t){const n=i(t);new Uint32Array(e.buffers.framebuffer.buffer,e.buffers.framebuffer.byteOffset,e.buffers.framebuffer.length/4).fill(n)},fill:function(t,o,r,a,f){const c=(e,t,i)=>Math.min(i,Math.max(t,e)),[s,u]=[t,t+r].map((t=>c(t,0,e.config.logical_width_px))),[d,l]=[o,o+a].map((t=>c(t,0,e.config.logical_height_px))),m=i(f);for(let e=d;e<l;e++)n(s,u,e,m)},trace:function(t){const i=function(t){let i="";for(;;){const n=new DataView(e.memory.buffer).getUint8(t++);if(0==n)break;i+=String.fromCharCode(n)}return i}(t);console.log(i)}}},a=document.getElementById("cartdata"),f=a.getAttribute("data-cart"),c=(Number(a.getAttribute("data-cartlen")),o(f,void 0)),{instance:s}=await WebAssembly.instantiate(c,r);return e.memory=s.exports.memory,e.exported_functions._configure=s.exports.configure,e.exported_functions._update=s.exports.update,e}var q,q0="\n    attribute vec2 a_position;\n    void main() {\n        gl_Position = vec4(a_position, 0, 1);\n    }\n",G0="\n    precision mediump float;\n    uniform sampler2D u_texture;\n    uniform vec2 u_resolution;\n    void main() {\n        vec2 uv = gl_FragCoord.xy / u_resolution;\n        gl_FragColor = texture2D(u_texture, uv);\n    }\n",J0=20,m=0,e=new Date,d=new Date,Q0=()=>{let e=!1;return t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0),e;var t},x=(e,t,i,n)=>{let o="u8"===e?1:"u16"===e?2:4;for(let e=0;e<o;e++)t[i+e]=n>>8*e&255};async function n(){const e=await O0(),t=e.exported_functions._configure();await X0(e,t),setInterval((()=>{z0(e),e.exported_functions._update()}),16.666666666666668);const i=document.getElementById("screen"),n=e.config.logical_width_px,o=e.config.logical_height_px;function r(){const t=i.parentNode.clientWidth,r=i.parentNode.clientHeight;e.info.device_width=t,e.info.device_height=r;const a=t/n,f=r/o;let c=Math.min(a,f);const s=Math.floor(n*c),u=Math.floor(o*c);i.style.width=s+"px",i.style.height=u+"px"}r(),window.addEventListener("resize",r);var a=document.getElementById("fpsOut");setInterval((function(){a.innerHTML=(1e3/m).toFixed(1)+" fps"}),1e3)}var f,r,W0=document.getElementById("screen"),w=document.getElementById("record-btn"),t=!1;w.addEventListener("click",(()=>{if(t=!t){w.textContent="Stop";const e=W0.captureStream(60);f=new MediaRecorder(e,{mimeType:"video/webm"}),r=[],f.ondataavailable=e=>{e.data.size>0&&r.push(e.data)},f.start()}else w.textContent="Record",f.stop(),setTimeout((()=>{const e=new Blob(r,{type:"video/webm"}),t=URL.createObjectURL(e),i=document.createElement("a");i.href=t,i.download="recording.webm",i.click(),URL.revokeObjectURL(t)}),0)})),n()</script></body></html>